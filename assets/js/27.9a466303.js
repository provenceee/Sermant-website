(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{473:function(t,e,a){"use strict";a.r(e);var n=a(26),s=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"heartbeat"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#heartbeat"}},[t._v("#")]),t._v(" Heartbeat")]),t._v(" "),e("p",[t._v("This document describes how the Sermant plugin uses the heartbeat function.")]),t._v(" "),e("p",[t._v("Heartbeat is one of the core services in "),e("a",{attrs:{href:"https://github.com/huaweicloud/Sermant/tree/develop/sermant-agentcore/sermant-agentcore-core",target:"_blank",rel:"noopener noreferrer"}},[e("strong",[t._v("Sermant")]),t._v(" core module"),e("OutboundLink")],1),t._v(". An instance of heartbeatService is obtained by:")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HeartbeatService")]),t._v(" heartbeatService "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceManager")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getService")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HeartbeatService")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("The heartbeat service starts execution when it is initialized, and periodically sends the name, version and other information of each plugin to the backend server. Currently, plugin heartbeats report information like:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("hostname")]),t._v(": The hostname of the sending client")]),t._v(" "),e("li",[e("code",[t._v("ip")]),t._v(": The ip of the sending client")]),t._v(" "),e("li",[e("code",[t._v("app")]),t._v(": Application name, as well as "),e("code",[t._v("appName")]),t._v(" in startup parameters")]),t._v(" "),e("li",[e("code",[t._v("appType")]),t._v(": Application typeï¼Œas well as "),e("code",[t._v("appType")]),t._v(" in startup parameters")]),t._v(" "),e("li",[e("code",[t._v("heartbeatVersion")]),t._v(": Time of last heartbeat")]),t._v(" "),e("li",[e("code",[t._v("lastHeartbeat")]),t._v(": Time of last heartbeat")]),t._v(" "),e("li",[e("code",[t._v("version")]),t._v(": The version of the core package, as well as the "),e("code",[t._v("sermant-version")]),t._v(" value of the core package "),e("code",[t._v("manifest")]),t._v(" file")]),t._v(" "),e("li",[e("code",[t._v("pluginInfoMap")]),t._v(": Current Sermant carried plugin information\n"),e("ul",[e("li",[e("code",[t._v("pluginName")]),t._v(": Plug-in name, which can be determined in the plug-in configuration file")]),t._v(" "),e("li",[e("code",[t._v("pluginVersion")]),t._v(": Plug-in version, which is the "),e("code",[t._v("Sermant-plugin-version")]),t._v(" value of the "),e("code",[t._v("manifest")]),t._v(" file in the plugin jar")]),t._v(" "),e("li",[e("code",[t._v("extInfo")]),t._v(": Additional content that the plug-in wants to report in the data that the plug-in reports")])])])]),t._v(" "),e("p",[t._v("If you want to add additional content to the data reported by the plugin, you can call the following API:")]),t._v(" "),e("div",{staticClass:"language-java extra-class"},[e("pre",{pre:!0,attrs:{class:"language-java"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// use ExtInfoProvider to add additional content")]),t._v("\nheartbeatService"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setExtInfo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExtInfoProvider")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),e("span",{pre:!0,attrs:{class:"token generics"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getExtInfo")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// do something")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=s.exports}}]);